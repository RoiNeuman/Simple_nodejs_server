{"version":3,"sources":["../../src/app/server.js"],"names":["app","server","listen","process","env","PORT","io","path","socketEvents","webpackCompiler","use","require","noInfo","publicPath","output","static","__dirname","contentErrorPageHeaders","contentHeader","get","req","res","test","header","serverStaticContent","redirect"],"mappings":"AAAA;AACA;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA;AACA,IAAMA,MAAM,wBAAZ;AAAA,IACCC,SAASD,IAAIE,MAAJ,CAAWC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAA/B,CADV;;AAGA;AACA,IAAMC,KAAK,qBAAaL,MAAb,EAAqB,EAACM,MAAM,EAAP,EAArB,CAAX;AACA,IAAMC,eAAe,+BAAgBF,EAAhB,CAArB;;AAEA;AACA,IAAMG,kBAAkB,+CAAxB;;AAEA;AACAT,IAAIU,GAAJ,CAAQ,sBAAO,KAAP,CAAR;AACAV,IAAIU,GAAJ,CAAQC,QAAQ,wBAAR,EAAkCF,eAAlC,EAAmD;AAC1DG,SAAQ,IADkD,EAC5CC,YAAY,wBAAcC,MAAd,CAAqBD;AADW,CAAnD,CAAR;AAGAb,IAAIU,GAAJ,CAAQC,QAAQ,wBAAR,EAAkCF,eAAlC,CAAR;;AAEA;;;;GAIG;AACH;AACAT,IAAIU,GAAJ,CAAQ,wBAAR,EAAkC,kBAAQK,MAAR,CAAeC,YAAY,kCAA3B,EAA+D,gCAAeC,uBAA9E,CAAlC;;AAEAjB,IAAIU,GAAJ,CAAQ,WAAR,EAAqB,kBAAQK,MAAR,CAAeC,YAAY,qBAA3B,EAAkD,gCAAeE,aAAjE,CAArB;;AAEAlB,IAAImB,GAAJ,CAAQ,GAAR,EAAa,UAASC,GAAT,EAAcC,GAAd,EAAmB;AAC/B;AACA,KAAG,UAAUC,IAAV,CAAeF,IAAIG,MAAJ,CAAW,YAAX,CAAf,CAAH,EACC,gCAAeC,mBAAf,CAAmC,2BAAnC,EAAgE,aAAhE,EAA+EH,GAA/E,EADD,KAGC,gCAAeG,mBAAf,CAAmC,oBAAnC,EAAyD,YAAzD,EAAuEH,GAAvE;AACD,CAND;AAOArB,IAAImB,GAAJ,CAAQ,QAAR,EAAkB,UAASC,GAAT,EAAcC,GAAd,EAAmB;AACpCA,KAAII,QAAJ,CAAa,GAAb;AACA,CAFD;AAGAzB,IAAImB,GAAJ,CAAQ,aAAR,EAAuB,UAASC,GAAT,EAAcC,GAAd,EAAmB;AACzCA,KAAII,QAAJ,CAAa,GAAb;AACA,CAFD;AAGAzB,IAAImB,GAAJ,CAAQ,GAAR,EAAa,UAASC,GAAT,EAAcC,GAAd,EAAmB;AAC/B,iCAAeG,mBAAf,CAAmC,oBAAnC,EAAyD,YAAzD,EAAuEH,GAAvE;AACA;AACA,CAHD","file":"server.js","sourcesContent":["/*jshint esversion: 6 */\r\n'use strict';\r\n\r\nimport express from 'express'\r\nimport logger from 'morgan'\r\nimport contentHandler from 'server_modules/handle_static_content'\r\nimport SocketIo from 'socket.io'\r\nimport socketIoHandler from 'server_modules/handle_socketIO'\r\nimport webpack from 'webpack'\r\nimport webpackConfig from '../../webpack.config.js'\r\n\r\n//\tServer setup\r\nconst app = express(),\r\n\tserver = app.listen(process.env.PORT || 7000);\r\n\r\n//\tSocket.io\r\nconst io = new SocketIo(server, {path: ''});\r\nconst socketEvents = socketIoHandler(io);\r\n\r\n//\tWebpack creation\r\nconst webpackCompiler = webpack(webpackConfig);\r\n\r\n//\tDev-mode\r\napp.use(logger('dev'));\r\napp.use(require(\"webpack-dev-middleware\")(webpackCompiler, {\r\n\tnoInfo: true, publicPath: webpackConfig.output.publicPath\r\n}));\r\napp.use(require(\"webpack-hot-middleware\")(webpackCompiler));\r\n\r\n/*\r\n\t/ , /index , /index.html\r\n\t/content/pages/errors/:file\r\n\t/content/:folder/:file\r\n*/\t// < Routes list\r\n//\tRoutes\r\napp.use('/content/pages/errors/', express.static(__dirname + '/../../src/content/pages/errors/', contentHandler.contentErrorPageHeaders));\r\n\r\napp.use('/content/', express.static(__dirname + '/../../src/content/', contentHandler.contentHeader));\r\n\r\napp.get('/', function(req, res) {\r\n\t//console.log(\"Process: \" + cluster.worker.id);\r\n\tif(/mobile/i.test(req.header('user-agent')))\r\n\t\tcontentHandler.serverStaticContent('src/content/pages/mobile/', 'Mindex.html', res);\r\n\telse\r\n\t\tcontentHandler.serverStaticContent('src/content/pages/', 'index.html', res);\r\n});\r\napp.get('/index', function(req, res) {\r\n\tres.redirect('/');\r\n});\r\napp.get('/index.html', function(req, res) {\r\n\tres.redirect('/');\r\n});\r\napp.get('*', function(req, res) {\r\n\tcontentHandler.serverStaticContent('src/content/pages/', 'index.html', res);\r\n\t//res.redirect('/content/pages/errors/404.html');\r\n});"]}